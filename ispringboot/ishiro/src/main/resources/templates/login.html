

<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="utf-8">
    <title>love</title>
    <link href="favicon.ico" rel="shortcut icon" />
    <link href="https://cdn.bootcss.com/twitter-bootstrap/3.4.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #rem{
            margin-top: 20px;
        }
    </style>
</head>
<body style=" background: url(http://global.bing.com/az/hprichbg/rb/RavenWolf_EN-US4433795745_1920x1080.jpg) no-repeat center center fixed; background-size: 100%;">


<div class="modal-dialog" style="margin-top: 10%;">
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="modal-title text-center" id="myModalLabel">登录</h4>
        </div>
        <form action="/user/login/process" method="post" id="form1">
        <div class="modal-body" id = "model-body">
            <div class="form-group">
                <input type="text" name="username"  class="form-control"placeholder="用户名" autocomplete="off">
            </div>
            <div class="form-group">
                <input type="password" name="password" class="form-control" placeholder="密码" autocomplete="off">
                <div id="rem"><label for="rm">自动登录</label><input id="rm" name="remember-me" type="checkbox"></div>
            </div>
        </div>
        <div class="modal-footer">
            <div class="form-group">
                <button type="button" onclick="isubmit()" class="btn btn-primary form-control">登录</button>
            </div>
            <div class="form-group">
                <button type="button" class="btn btn-default form-control">注册</button>
            </div>
        </div>
        </form>
    </div><!-- /.modal-content -->
</div><!-- /.modal -->

</body>
<script src="/js/jquery-3.3.1.min.js"></script>
<script>
    function formDataToJSON(obj) {
        let params = obj.serializeArray();//需要一个JQuery对象
        let values = {};
        for (let item in params) {
            values[params[item].name] = params[item].value;
        }
        return JSON.stringify(values);
    }
    $(function (){
        $('#form1 input[name="username"]').focus();
    });
    function isubmit(){
       // $('#form1').submit();
        let data = $('#form1').serialize()

       // alert(data)
        $.ajax({
                type:"post",
                url:`/user/login/process`,
                contentType:"application/x-www-form-urlencoded;charset=utf-8",
                dataType:"json",
                data:data,
                success: function (result) {
                    if(result){
                        alert(result.message)
                        if(result.code===2){
                            location.href = "http://localhost/";
                        }
                    }else{
                        alert("出错了，请联系管理员;")
                    }
                },
                error:function (error) {
                    console.log(error)
                    alert(Object.values(error))
                }
            }
        )
    }
</script>
</html>
